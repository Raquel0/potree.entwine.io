<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Greyhound Potree Viewer</title>

	<link rel="stylesheet" type="text/css" href="../build/potree/potree.css">
	<link rel="stylesheet" type="text/css" href="../libs/jquery-ui-1.11.4/jquery-ui.css">
	<link rel="stylesheet" type="text/css" href="../libs/perfect-scrollbar/css/perfect-scrollbar.css">
	<link rel="stylesheet" href="../libs/openlayers3/ol.css" type="text/css">
    <link rel="stylesheet" href="../css/entwine.css" type="text/css">
  </head>

  <body>
    <script type="text/javascript">
        window.config = {
            resource: 'mn-z',
            material: 'Elevation',
            fov: 100,
            intensityGamma: 0.6,
            pointSize: 3,
            edlStrength: .1,
            near: 50,
            far: 100000000,
            pointBudget: 4.0 * 1000 * 1000,
            position: [-10496264.62, 5566073.05, 386427.25],
            target: [-10496369.07, 5670678.04, 44901.97],
            elevationRange: [100, 500],
            classificationFilter: [7]
        };
    </script>
	<script src="../libs/jquery/jquery-3.1.1.min.js" type="text/javascript"></script>
	<script
         src="../libs/perfect-scrollbar/js/perfect-scrollbar.jquery.js"
         type="text/javascript"></script>
	<script src="../libs/jquery-ui/jquery-ui.min.js" type="text/javascript"></script>
	<script src="../libs/three.js/build/three.js" type="text/javascript"></script>
	<script src="../libs/other/stats.min.js" type="text/javascript"></script>
	<script src="../libs/other/BinaryHeap.js" type="text/javascript"></script>
	<script src="../libs/tween/tween.min.js" type="text/javascript"></script>
	<script src="../libs/d3/d3.js" type="text/javascript"></script>
	<script src="../libs/proj4/proj4.js" type="text/javascript"></script>
	<script src="../libs/openlayers3/ol.js" type="text/javascript"></script>
    <script src="../libs/i18next/i18next.js" type="text/javascript"></script>
    <script src="../libs/clipboard.min.js" type="text/javascript"></script>
	<script src="../build/potree/potree.js" type="text/javascript"></script>

    <div id="potree_container">
        <a href="/" id="entwine_logo_container">
            <img id="entwine_logo" src="/resources/images/entwine-logo.png"/>
        </a>
        <img id="entwine_copy" src="/resources/icons/entwine-share.svg"
            title='Share a link with current view settings'
            onclick="$('#entwine_copied').show()"
            onmouseleave="$('#entwine_copied').hide()"
        />
        <div id="entwine_copied">Copied shareable link</div>
        <img id="entwine_toggle"
             state='on'
             src="/resources/icons/entwine-annotations-on.svg"
             title='Toggle annotations'
             onclick="toggleAnnotations()"
        />
		<div id="potree_render_area">
			<img class="potree_menu_toggle"
                src="../resources/icons/menu_button.svg"
                onclick="viewer.toggleSidebar()"
            />
			<img id="potree_map_toggle"
                src="../resources/icons/map_icon.png"
                onclick="viewer.toggleMap()"
            />
			<div id="potree_map" class="mapBox">
                <div id="potree_map_header"></div>
				<div id="potree_map_content" class="map"></div>
			</div>
			<div id="potree_description" class="potree_info_text"></div>
		</div>
		<div id="potree_sidebar_container"></div>
    </div>
    <script type="text/javascript" src="script.js"></script>
    <script type="text/javascript">
        var getQueryParam = function(name) {
            name = name.replace(/[\[\]]/g, '\\$&');
            var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)');
            var results = regex.exec(window.location.href);
            if (!results) return null;
            if (!results[2]) return true;

            return decodeURIComponent(results[2].replace(/\+/g, ' '));
        }

        if (getQueryParam('ann') !== '0')
        {
            var Vec = (v) => new THREE.Vector3(v[0], v[1], v[2]);

            var annotations = [
                {
                    name: "State Capitol Building",
                    pos: [-10364091.69, 5614426.38, 270.16],
                    cpos: [-10363998.71, 5614333.20, 370.21],
                    ctgt: [-10364064.35, 5614445.49, 290.11]
                },
                {
                    name: "Target Field",
                    pos: [-10383639.69, 5618648.05, 251.75],
                    cpos: [-10383804.97, 5618736.76, 419.21],
                    ctgt: [-10383647.19, 5618639.77, 251.81]
                },
                {
                    name: "Hull–Rust–Mahoning Open Pit Iron Mine",
                    pos: [-10344309.25, 6016590.75, 517.25],
                    cpos: [-10342964.39, 6017111.79, 1710.00],
                    ctgt: [-10343903.78, 6016575.41, 523.82]
                },
                {
                    name: "Lock & Dam 4",
                    pos: [-10179188.44, 5464877.97, 198.84],
                    cpos: [-10178961.34, 5466107.74, 827.19],
                    ctgt: [-10178777.84, 5465155.67, 43.73]
                },
                {
                    name: "Split Rock Lighthouse",
                    pos: [-10170923.94, 5974770.56, 223.47],
                    cpos: [-10170684.50, 5974774.50, 266.46],
                    ctgt: [-10170916.18, 5974781.99, 211.85]
                }
            ];

            annotations.forEach((v) => viewer.scene.addAnnotation(
                        Vec(v.pos),
                        {
                            title: v.name,
                            cameraPosition: Vec(v.cpos),
                            cameraTarget: Vec(v.ctgt),
                            actions: v.actions
                        }));

            $(".annotation").last().find("img").css("filter", "invert(0)");
            $(".annotation-item").last().find("img").last().css("filter", "invert(0)");

            $("#menu_annotations").next().show();
        }
    </script>
  </body>
</html>


